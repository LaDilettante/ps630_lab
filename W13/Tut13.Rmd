---
title: "Tutorial 13: Autocorrelation, Fixed vs. Random Effects, and Causal Inference Techniques"
author: "Jan Vogler (jan.vogler@duke.edu)"
date: "November 20, 2015"
output: pdf_document
---

# Today's Agenda

1. Autocorrelation in Time and Space
2. Fixed-effects vs. random-effects regression
3. Differences-in-differences
4. Regression discontinuity designs



# 1. Autocorrelation in Time and Space

Create lags of dependent and independent variables with DataCombine.

install.packages("DataCombine")

```{r,tidy=TRUE,error=TRUE}
library(DataCombine)

which()

toLag = c()

for (lagVar in toLag){
combi1=slide(combi1, Var=lagVar, TimeVar="year", GroupVar="stcode", NewVar=paste0("lag1_",lagVar), slideBy = -1, keepInvalid = FALSE, reminder = TRUE)
}

for (lagVar in toLag){
  combi1=slide(combi1, Var=lagVar, TimeVar="year", GroupVar="stcode", NewVar=paste0("lag2_",lagVar), slideBy = -2, keepInvalid = FALSE, reminder = TRUE)
}

for (lagVar in toLag){
  combi1=slide(combi1, Var=lagVar, TimeVar="year", GroupVar="stcode", NewVar=paste0("lag3_",lagVar), slideBy = -3, keepInvalid = FALSE, reminder = TRUE)
}
```

Durbin-Watson Test

```{r}
library(car)
```

Newey West Standard Errors

```{r}
library(lmtest)
coeftest(model, NeweyWest(model, lag=3))
```



# 2. Fixed-effects vs. random-effects regression

We have seen fixed effects previously. We can simply integrate fixed effects by using the factor() command.

```{r}
lm()
```

Now let's introduce RE.

```{r}
library(lme4)
```



# 3. Differences-in-differences

Differences-in-differences analysis makes use of parallel time trends.



# 4. Regression discontinuity designs

Regression discontinuity designs are powerful tools for causal inference.

install.packages("rdd")

```{r,tidy=TRUE}
library(rdd)
```



## Remember

```{r,tidy=TRUE}
fun=c("R","is","fun")
paste(fun, collapse=" ")
```